#import "iAPVerification.h"

- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions {
	for (SKPaymentTransaction *transaction in transactions) {
		[iAPVerification verifyPurchase:transaction isSandbox:YES delegate:self];
	}
}

- (void)verificationFailed:(iAPErrorCode)errorCode error:(NSError *)error paymentTransaction:(SKPaymentTransaction *)paymentTransaction {
	NSLog(@"%d, %@", errorCode, error);
}

- (void)purchaseVerified:(NSDictionary *)dictionary {
	//NSLog(@"%@", dictionary);
	
	NSString *productId = [dictionary objectForKey:@"product_id"];
	
	if ([productId isEqualToString:@"com.powerflightapp.iap.1"]) {
		// Provide content
	}
	
	SKPaymentQueue *queue = [SKPaymentQueue defaultQueue];
	NSString *transactionId = [dictionary objectForKey:@"transaction_id"];
	
	for (SKPaymentTransaction *transaction in queue.transactions) {
		if ([transactionId isEqualToString:transaction.transactionIdentifier]) {
			[queue finishTransaction:transaction];
		}
	}
}