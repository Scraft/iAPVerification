#import "iAPVerification.h"

- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions {
	for (SKPaymentTransaction *transaction in transactions) {
		switch (transaction.transactionState) {
			case SKPaymentTransactionStatePurchased:
				[iAPVerification verifyPurchase:transaction isSandbox:YES delegate:self];					break;
			
			case SKPaymentTransactionStateRestored:
				[iAPVerification verifyPurchase:transaction isSandbox:YES delegate:self];
				break;
		}
	}
}

- (void)verificationFailed:(int)errorCode error:(NSError *)error {
	NSLog(@"%d, %@", errorCode, error);
}

- (void)purchaseVerified:(NSDictionary *)dictionary {
	//NSLog(@"%@", dictionary);
	
	NSString *productId = [dictionary objectForKey:@"product_id"];
	
	if ([productId isEqualToString:@"com.powerflightapp.iap.1"]) {
		// Provide content
		
		SKPaymentQueue *queue = [SKPaymentQueue defaultQueue];
		[queue finishTransaction:[queue.transactions objectAtIndex:0]];
	}
}